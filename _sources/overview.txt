概要
=========================
icebergとは
-------------------------
icebergはシンプルで拡張性の高いコマンドラインランチャです。以下のような機能があります。

- 前方一致、部分一致、あいまい検索
- migemo検索
- ヒストリ検索
- Lua関数の呼び出し

.. image:: images/screenshot_01.jpg

.. image:: images/iceberg_demo_01.gif

.. image:: images/iceberg_demo_02.gif

インストール
-------------------------
Windows
~~~~~~~~~~~~~~~
`Release <https://github.com/yuin/iceberg/releases>`_ で配布されているアーカイブを任意の場所に解凍してください。レジストリは使用していません。

Linux(Ubuntu 14.04)
~~~~~~~~~~~~~~~~~~~~~~~~~
以下のライブラリが必要です。 ``apt-get`` コマンドでインストールしてください。

- g++
- gdb
- autoconf
- libpng12-0-dev
- libpng++-dev
- libjpeg8-dev
- libjpeg-turbo8-dev
- libftgl2
- libfontconfig
- libx11-dev
- libglu1-mesa-dev
- libasound2-dev
- libxft-dev
- libonig-dev
- libmigemo-dev

`Release <https://github.com/yuin/iceberg/releases>`_ で配布されているソースコードを任意の場所に解凍してください。その後

    .. code-block:: bash
    
        % ./tools/install_requires.sh
        % make
        % sudo make install

と実行してください。sudoを実行したユーザのホームディレクトリに ``.iceberg`` ディレクトリが作成され、デフォルトの設定ファイルなどがコピーされます。


Linux上での文字コードはutf-8のみがサポートされています。

Linux(その他)
~~~~~~~~~~~~~~~
動作確認されていませんが、Ubuntuと同等のライブラリをインストールすればコンパイルできる可能性があります。g++は4.9以上を利用してください。また、動作が確認できましたらぜひ作者までお知らせください。

使用法
-------------------------
以下ではデフォルトの設定を例にします。

コマンド登録
~~~~~~~~~~~~~~~

まず、コマンドを登録する必要があります。 ``:scan_search_path all`` と入力しEnterを押下してください。この操作でスタートメニューのアプリケーションが自動で登録されます。ユーザが独自にコマンドを登録する簡単な方法は以下です。

コマンド履歴、キャッシュなどはすべてWindowsの場合iceberg.exeが存在するディレクトリ、その他のプラットフォームの場合 ``~/.iceberg`` ディレクトリに作成されます。これをicebergディレクトリと呼びます。

1. icebergディレクトリにある ``shortcuts`` ディレクトリ内にショートカット( Windowsの場合、 ``*.lnk`` , Linuxの場合 ``.desktop`` )を作成します。
    - ショートカットに設定した実行ディレクトリ、コメントはicebergにも引き継がれます。
2. icebergで ``:scan_search_path shortcuts`` を実行します。

icebergではそのほか、以下のような方法でコマンド登録が行えます。

- サーチパスを用いる方法
    1. configファイルにサーチパスを定義します。
    2. ``:scan_search_path CATEGORY`` を実行します。 ``CATEGORY`` には1で定義したサーチパスのカテゴリもしくは ``all`` を入力します。
        - サーチパスにマッチするファイルがicebergのコマンドとして取り込まれます。
- configファイルに直接記載する方法: 詳しい設定方法は :doc:`config` を参照してください。

組み込みコマンド
~~~~~~~~~~~~~~~~~~~~~~~~~
以下のコマンドが組み込みコマンドとして提供されています。組み込みコマンドは ``:`` から始まります。

- `:version` : icebergのバージョンを表示します。
- `:exit` : icebergを終了します。
- `:reboot` : icebergを終了します。
- `:pwd` : icebergのカレントディレクトリを表示します。
- `:cd`  : icebergのカレントディレクトリを変更します。
- `:scan_search_path`  : サーチパスを再検索します。
- `:opendir` : 引数のコマンドもしくはディレクトリを開きます。
- `:empty` : 特別なコマンドです。入力欄になにも入力せずにEnterを実行した場合このコマンドが実行されます。デフォルトではWinowsの場合、最前面のエクスプローラで表示しているディレクトリをカレントディレクトリとしてコマンドプロンプトを開きます。その他のプラットフォームの場合、icebergのカレントディレクトリでターミナルを開きます。

その他、以下のコマンドがデフォルトで用意されています。

- `google` : Googleで第一引数の単語を検索する。
- `cal` : ``cal 10+2`` のように計算を行える計算機。

以下はWindows版のみデフォルトで用意されています。

- `control_panel` : コントロールパネルを表示する。
- `windows_service` : サービスを表示する。
- `my_computer` : マイコンピュータを表示する。
- `network_computer` : ネットワークコンピュータを表示する。
- `mkdir` : 最前面のエクスプローラで表示されているディレクトリに第一引数の名前をもつディレクトリを作成する。
- `weather` : 日本の主要都市の天気を表示します(このコマンドはインターネット上から情報を取得するため、インターネット接続不可の場合情報が表示できません）。 ``weather`` と入力した後半角スペースを入力すると天気リストが表示されます。
- `alttab` : ``alt+tab`` キーを押したときのような、ウインドウ切り替えコマンドです。 ``alttab`` と入力した後半角スペースを入力するとウインドウリストが表示されます。
- `clipboard` : クリップボード履歴一覧を表示します。候補を選択するとクリップボードにコピーされます。

以下はLinux版のみデフォルトで用意されています。

- `locate` : ``locate .txt`` のようにするとファイルを検索することができます。
- `kill` : killコマンドを実行します。対象プロセス名で補完することができます。

カレントディレクトリ
~~~~~~~~~~~~~~~~~~~~~~~~~~
icebergはカレントディレクトリを保持しています。組み込みコマンド ``:pwd`` で表示、 ``:cd`` で変更できます。

表示と実行
~~~~~~~~~~~~~~~~
``ctrl-space`` を押下するとicebergが表示されます。なにかキーを入力すると補完候補が表示されます。 ``ctrl-p`` および ``ctrl-n`` で補完候補を選んで ``Enter`` を押すとコマンドが実行されます。その際、 ``!notepad`` のようにコマンドの先頭に ``!`` を付与するとコマンドに紐づけられた実行ディレクトリではなく、icebergのカレントディレクトリで実行されます。入力は ``"aaa bbb"`` のように ``"`` でくくることにより空白を含めることができます。

また ``c:/`` や ``./`` のように入力すると簡易ファイラとして利用することができます。Windowsでは  ``/`` または ``\`` を入力するとドライブ一覧を表示します。

.. note:: 
    Windowsではパスの区切り文字には ``/`` もしくは ``\`` が使用できますが、特定のケースでは ``/`` しか使用できません。
    たとえば ``"C:\Document and Settings\name"`` と入力欄に表示されている場合 ``"C:\Document and Settings\name\"`` とは入力できません。 ``name`` の直後の ``\`` は最後の ``"`` に対するエスケープ文字として認識されます。このようなケースでは ``/`` を使用してください。

ショートカット
~~~~~~~~~~~~~~~~
icebergになにかを入力した状態で ``Enter`` 以外の特別なキーを押すことによりicebergに入力されている文字列を引数としてコマンドを実行することができます。例えば、デフォルトではコマンドを入力した状態で ``ctrl-d`` を押すとそのコマンドのディレクトリを開きます。

非表示にする
~~~~~~~~~~~~~~~~
``escape`` を押下するとicebergを非表示にできます。

モード切り替え
~~~~~~~~~~~~~~~~
``ctrl-r`` を押下するとノーマルモードとヒストリモードを切り替えることができます。ヒストリモードでは引数も含めて過去に入力したコマンドから補完することができます。

migemo検索
~~~~~~~~~~~~~~~
Windowsの場合、iceberg実行ファイルのディレクトリに ``migemo.dll`` を ``dict`` ディレクトリ配下に辞書ファイルを配置することによりmigemo機能が有効となります。migemoのバージョンは ``cmigemo-1.3c`` で動作確認をしています。前方一致・部分一致検索を行う場合に日本語ファイルにもマッチするようになります。ファイル配置は以下のようになります。::

    iceberg.exe
    migemo.dll
    dict/ 
       han2zen.dat
       hira2kata.dat
       migemo-dict
       roma2hira.dat
       zen2han.dat

その他のプラットフォームの場合、ライブラリパスに ``libmigemo.so`` を、 ``~/.iceberg/dict`` ディレクトリ配下に辞書ファイルを配置するとmigemo機能が有効となります。辞書ファイルの文字コードはutf-8のものを利用してください。

外部からのコマンド送信
~~~~~~~~~~~~~~~~~~~~~~~~~
以下のように起動することで、外部から起動済みのicebergにコマンドを送信することができます。この機能を利用するためには ``system.server_port`` を ``0`` 以外に設定しておく必要があります。

::

    iceberg.exe -m "exec 実行したいコマンド"
    iceberg.exe -m "set 入力欄にセットしたい文字列"
    iceberg.exe -m "activate"


より進んだ使い方
------------------------

詳しい使い方や設定方法は :doc:`config` , :doc:`api` , :doc:`plugin` や :doc:`tips` を参照してください。
